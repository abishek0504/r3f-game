import{j as e,a as l,d as _,R as $,C as ne}from"./fiber-CTKNTuSz.js";import{u as M,c as me,s as ce,a as ue,T as H,C as le,b as de,d as he,P as ge,E as ye,e as pe,K as we,R as Se}from"./drei-CWCRXMdk.js";import{R as h,C,a as p,P as xe}from"./rapier-a4DnuYWM.js";import{f as E,af as V,C as G,aZ as fe,a_ as je,a$ as ve,b0 as Pe}from"./three-Bf_OjMC4.js";import"./react-DbHEDQBy.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();function Me(o){const{nodes:r,materials:t}=M("/models/characters/character.glb");return e.jsx("group",{...o,dispose:null,children:e.jsx("mesh",{geometry:r.ducky.geometry,material:t.tiny_treats_1,scale:100,castShadow:!0})})}function be({position:o=[0,0,0],rotation:r=[0,0,0],scale:t=2}){return e.jsx("group",{position:o,rotation:r,children:e.jsx(Me,{scale:t})})}M.preload("/models/characters/character.glb");const w=me(ce((o,r)=>({phase:"menu",stage:1,message:"",showMessage:!1,isTransitioning:!1,messageTimeout:null,dateProposalState:{noClickCount:0,bothButtonsYes:!1,dateAccepted:!1},hasFallen:!1,playerPosition:[0,1,0],playerRotation:[0,0,0],isMoving:!1,crates:[{id:"crate-1",position:[3,.5,2],isOnPressurePlate:!1},{id:"crate-2",position:[-2,.5,3],isOnPressurePlate:!1},{id:"crate-3",position:[4,.5,-2],isOnPressurePlate:!1}],pressurePlates:[{id:"plate-1",position:[4,.1,4],isPressed:!1,doorId:"door-1"},{id:"plate-2",position:[-4,.1,-4],isPressed:!1,doorId:"door-2"},{id:"button-1",position:[6,0,0],isPressed:!1,doorId:"door-1"},{id:"button-2",position:[-6,0,0],isPressed:!1,doorId:"door-1"}],doors:[{id:"door-1",position:[0,0,5],isOpen:!1},{id:"door-2",position:[5,0,0],isOpen:!1}],goal:{position:[8,.5,8],isReached:!1},start:()=>o({phase:"playing"}),restart:()=>o({phase:"playing",playerPosition:[0,1,0],playerRotation:[0,0,0],crates:[{id:"crate-1",position:[3,.5,2],isOnPressurePlate:!1},{id:"crate-2",position:[-2,.5,3],isOnPressurePlate:!1},{id:"crate-3",position:[4,.5,-2],isOnPressurePlate:!1}],pressurePlates:[{id:"plate-1",position:[4,.1,4],isPressed:!1,doorId:"door-1"},{id:"plate-2",position:[-4,.1,-4],isPressed:!1,doorId:"door-2"}],doors:[{id:"door-1",position:[0,0,5],isOpen:!1},{id:"door-2",position:[5,0,0],isOpen:!1}],goal:{position:[8,.5,8],isReached:!1}}),nextStage:()=>o(t=>({stage:t.stage+1,phase:"playing",playerPosition:[0,1,0],playerRotation:[0,0,0],message:"",showMessage:!1,isTransitioning:!1})),gameOver:()=>o({phase:"game-over"}),completeLevel:()=>o({phase:"level-complete"}),setPlayerPosition:t=>o({playerPosition:t}),setPlayerRotation:t=>o({playerRotation:t}),setIsMoving:t=>o({isMoving:t}),updateCratePosition:(t,s)=>o(a=>({crates:a.crates.map(i=>i.id===t?{...i,position:s}:i)})),updatePressurePlate:(t,s)=>o(a=>{const i=a.pressurePlates.map(c=>c.id===t?{...c,isPressed:s}:c),n={};i.forEach(c=>{n[c.doorId]||(n[c.doorId]=[]),n[c.doorId].push(c.isPressed)});const m=a.doors.map(c=>{const g=n[c.id]||[],y=g.length>0&&g.every(v=>v);return{...c,isOpen:y}}),d=i.find(c=>c.id==="button-1"),u=i.find(c=>c.id==="button-2");return d!=null&&d.isPressed&&(u!=null&&u.isPressed)&&(o({playerPosition:[0,1,1],playerRotation:[0,0,0],message:"Good Job Bubba !! <3",showMessage:!0}),setTimeout(()=>{o({showMessage:!1}),setTimeout(()=>{o({stage:r().stage+1,message:"",showMessage:!1})},300)},6e3)),{pressurePlates:i,doors:m}}),resetPlayerPosition:(t="")=>{const s=r();if(s.messageTimeout&&clearTimeout(s.messageTimeout),o({playerPosition:[0,s.stage===2?3:1,1],playerRotation:[0,0,0],message:t,showMessage:t!=="",hasFallen:!1}),t!==""){const a=setTimeout(()=>{o({showMessage:!1,messageTimeout:null})},6e3);o({messageTimeout:a})}},handleDateResponse:t=>{const s=r();if(s.messageTimeout&&clearTimeout(s.messageTimeout),t==="yes"){o({message:"Yay! I love you bubba!! Oooooma  <3 ",showMessage:!0,dateProposalState:{...s.dateProposalState,dateAccepted:!0}});const a=setTimeout(()=>{o({showMessage:!1,messageTimeout:null})},8e3);o({messageTimeout:a})}else{const a=s.dateProposalState.noClickCount+1,i=["That was clearly a misclick. No worries. Try again.","I'll just pretend I didn't see that.","Error: 'No' is not a valid input. Please select 'Yes'.","Initiating quantum recalculationâ€¦ Surely you meant 'Yes'?","Nice try, but the algorithm is biased toward love.","Every time you click 'No,' a duck forgets how to quack.","eeeeeeeeeee","404: Yes not found. Reattempting...",`You've activated sad mode ðŸ˜¢ 
Try again?`,"Please? I already told my grandma we're going.","Nice joke. Now seriously, hit yes.","AI detected sarcasm. Redirecting to YESâ€¦","Simulating alternate reality where you said Yes...","That's okayâ€¦ I'll just sit here and wait. Forever.","You said noâ€¦ but your heart said yes, right?","I'll ask again, but this time with boba eyes ðŸ¥º","Okay. But just knowâ€¦ you're breaking my Minecraft bed.","*dramatic gasp* HOW COULD YOU.","Cool cool coolâ€¦ totally fineâ€¦ I didn't cry or anything.","Say no again and I unleash the raccoons.","Every time you click 'No,' a baby carrot dies.","That's fine. I didn't want to go anyway. *closes 47 tabs of date ideas*","You've unlocked my final form: Sad Ninja Mode ðŸ¥·ðŸ’”","Even Naruto didn't give up on Sasukeâ€¦ and you're giving up on me?!","Wow. I gave you a love story and you said no like Juliet's dad.","Are you saying baby, baby, babyâ€¦ no?","You said noâ€¦ but my ninja way says to never give up!","Are you using a genjutsu? Because this reality doesn't make sense.","The next no click leads to a thousand years of pain.","Bubba I'll do it fr","Ain't no way","This hurts more than when Zayn left ðŸ˜©","Story of my life ðŸŽ¶ ask them out ðŸŽµ they click no.","Let me give you a helping hand <3"],n=Math.min(a-1,i.length-1),m=i[n],d=n===i.length-1;o({playerPosition:[0,1,2],playerRotation:[0,0,0],message:m,showMessage:!0,dateProposalState:{...s.dateProposalState,noClickCount:a,bothButtonsYes:d}});const u=setTimeout(()=>{o({showMessage:!1,messageTimeout:null})},6e3);o({messageTimeout:u})}},checkPlayerFall:()=>{const{playerPosition:t,messageTimeout:s,stage:a}=r(),i=Math.sqrt(t[0]*t[0]+t[2]*t[2]),n=10,m=-1,d=n+5;if(t[1]<=m||i>d){console.log("Player has fallen off the stage! Resetting position..."),console.log("Position:",t,"Distance from center:",i),o({hasFallen:!0}),s&&clearTimeout(s),o({playerPosition:a===2?[0,3,0]:[0,1,0],playerRotation:[0,0,0],message:`Oops I think you fell! 
 cafeFell for me :3`,showMessage:!0,hasFallen:!1});const g=setTimeout(()=>{o({showMessage:!1,messageTimeout:null})},6e3);o({messageTimeout:g})}},checkPressurePlates:()=>{const{crates:t,pressurePlates:s,doors:a}=r(),i=s.map(m=>{const d=t.some(u=>Math.sqrt(Math.pow(u.position[0]-m.position[0],2)+Math.pow(u.position[2]-m.position[2],2))<1);return{...m,isPressed:d}}),n=a.map(m=>{const d=i.find(u=>u.doorId===m.id);return{...m,isOpen:d?d.isPressed:m.isOpen}});o({pressurePlates:i,doors:n})},checkGoal:()=>{const{playerPosition:t,goal:s,phase:a}=r();if(a!=="playing")return;Math.sqrt(Math.pow(t[0]-s.position[0],2)+Math.pow(t[2]-s.position[2],2))<1.5&&!s.isReached&&o({goal:{...s,isReached:!0},phase:"level-complete"})}})));function Ie(){const o=l.useRef(),r=l.useRef(),[t]=l.useState(()=>new E(10,10,10)),[s]=l.useState(()=>new E),[a,i]=l.useState(!1),[n,m]=l.useState(!1),d=w(S=>S.playerPosition),u=w(S=>S.playerRotation),c=w(S=>S.showMessage),g=w(S=>S.stage),y=w(S=>S.resetPlayerPosition),[,v]=ue(),b=5,f=g===2?1.5:2.5,A=g===2?2:3;l.useEffect(()=>{i(!1)},[]),l.useEffect(()=>{r.current&&c&&(r.current.setTranslation({x:d[0],y:d[1],z:d[2]},!0),r.current.setRotation({x:u[0],y:u[1],z:u[2],w:1},!0),r.current.setLinvel({x:0,y:0,z:0},!0),r.current.setAngvel({x:0,y:0,z:0},!0))},[d,u,c]);const I=()=>{if(!r.current)return!1;const S=r.current.linvel();return Math.abs(S.y)<.1};return _((S,O)=>{const{forward:Q,backward:ee,leftward:te,rightward:re,jump:oe}=v();if(!r.current)return;const U=r.current.linvel(),R={x:0,y:0,z:0},D=12*O;Q&&(R.z-=D),ee&&(R.z+=D),te&&(R.x-=D),re&&(R.x+=D),r.current.applyImpulse(R,!0);const j=r.current.linvel();if(Math.sqrt(j.x*j.x+j.z*j.z)>A){const B=Math.sqrt(j.x*j.x+j.z*j.z),Y=A/B;r.current.setLinvel({x:j.x*Y,y:j.y,z:j.z*Y},!0)}const N=I();if(N!==a&&i(N),oe&&N&&(console.log("Jumping!"),i(!1),r.current.applyImpulse({x:0,y:f,z:0},!0)),o.current){if(Math.abs(R.x)>0||Math.abs(R.z)>0){let Y=Math.atan2(R.x,R.z),T=o.current.rotation.y;T=T%(Math.PI*2),T<0&&(T+=Math.PI*2);let F=Y-T;F>Math.PI&&(F-=Math.PI*2),F<-Math.PI&&(F+=Math.PI*2),o.current.rotation.y=V.lerp(T,T+F,O*b)}if(Math.abs(U.x)>.1||Math.abs(U.z)>.1){const B=S.clock.getElapsedTime();o.current.rotation.x=Math.sin(B*10)*.1}else o.current.rotation.x=V.lerp(o.current.rotation.x,0,O*5)}const x=r.current.translation(),ae=10,se=-1,ie=ae+5,q=Math.sqrt(x.x*x.x+x.z*x.z);(x.y<=se||q>ie)&&!n&&(console.log("Player has fallen off the stage! Resetting position..."),console.log("Position:",x,"Distance from center:",q),m(!0),y("Oops I think you fell! Fell for me :3"),setTimeout(()=>{m(!1)},2e3));const z=new E;z.copy(new E(x.x,x.y,x.z)),z.z+=10,z.y+=g===2?4.5:3.5;const W=new E;W.copy(new E(x.x,x.y,x.z)),W.y+=.5,t.lerp(z,O*5),s.lerp(W,O*5),S.camera.position.copy(t),S.camera.lookAt(s)}),e.jsxs(h,{ref:r,colliders:!1,mass:1,type:"dynamic",position:[0,.5,0],enabledRotations:[!1,!1,!1],linearDamping:4,angularDamping:1,restitution:.2,children:[e.jsx(C,{args:[.5,.3],position:[0,.5,0]})," ",e.jsxs("group",{ref:o,children:[e.jsx(be,{scale:2})," "]})]})}function K({position:o=[0,0,0],rotation:r=[0,0,0],scale:t=1}){const s=l.useRef(),{scene:a}=M("/models/environment/Tree.glb"),i=a.clone();return i.traverse(n=>{n.isMesh&&(n.castShadow=!0,n.receiveShadow=!0)}),e.jsx("group",{ref:s,position:o,rotation:r,scale:t,dispose:null,children:e.jsx("primitive",{object:i})})}function J({position:o=[0,0,0],rotation:r=[0,0,0],scale:t=1}){const s=l.useRef(),{scene:a}=M("/models/environment/Tree-2.glb"),i=a.clone();return i.traverse(n=>{n.isMesh&&(n.castShadow=!0,n.receiveShadow=!0)}),e.jsx("group",{ref:s,position:o,rotation:r,scale:t,dispose:null,children:e.jsx("primitive",{object:i})})}function k({type:o="pine",...r}){switch(o){case"pine":return e.jsx(K,{...r});case"oak":return e.jsx(J,{...r});case"willow":return e.jsx(K,{...r,rotation:[0,Math.PI/2,0]});case"maple":return e.jsx(J,{...r,rotation:[0,Math.PI/3,0]});default:return e.jsx(K,{...r})}}M.preload("/models/environment/Tree.glb");M.preload("/models/environment/Tree-2.glb");function Re(o){const{nodes:r,materials:t}=M("/models/environment/grass.glb"),s=l.useRef();return l.useEffect(()=>{s.current&&s.current.traverse(a=>{a.isMesh&&(a.castShadow=!0,a.receiveShadow=!0)})},[]),e.jsxs("group",{ref:s,...o,dispose:null,children:[e.jsx("mesh",{geometry:r.group1794255474.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group465525233.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group945836210.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group177561954.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1325005311.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1072724566.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group46854911.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group612556706.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group449492179.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group605530832.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1435258648.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group864490805.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group428921522.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group524873445.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2009401889.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1728649006.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2019195407.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group902223660.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1098759411.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group619381689.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1015050773.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group560011666.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group277299665.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1771443755.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1610547470.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group626770735.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2068281935.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group210888072.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group185352091.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group252032136.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group921605076.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1231211992.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group679110746.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group197740156.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group815277652.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group360483531.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1835338800.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group136955587.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1169478811.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1739232575.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1336776763.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group678362861.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1290443178.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group325242087.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group208637188.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1744197509.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group741765028.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1825840008.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1697339476.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group680255540.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1681983211.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group343340000.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group908757786.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1004251022.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1738312072.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group443349435.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group228620189.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1681556686.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2043014497.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group895360453.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1661925368.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1255547812.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1101659140.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group466636466.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group90724797.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group895877390.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group392390777.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1364464212.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2006479526.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1197058302.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1195822278.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group550118140.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group176000742.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group54891894.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1029047492.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1885921488.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1617287933.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1776261157.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1395833776.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group585753258.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group680158788.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group140092292.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group71196313.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group337239005.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group385588931.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1703757123.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group218941515.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group735598598.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1167406787.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group661845242.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1471392496.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1446851719.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1065125779.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1839719572.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group401017671.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group112180613.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1878667904.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2123004332.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1005795212.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1146485798.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2087063296.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1936780681.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1782188534.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group365366427.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group17328841.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group9935422.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1617591992.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group347157555.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1156293577.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group83513579.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group360301143.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1495017289.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group634990601.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1802575187.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group154558183.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1631824442.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group155764351.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1389552371.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1125402105.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1431712721.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group999589626.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group249842934.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1785550361.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group17442797.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2134981098.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2096342164.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group606296887.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group841952725.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1873517998.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group387490975.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group165008933.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group554188583.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group768271975.geometry,material:t.mat9,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group812634329.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group949318687.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1297739552.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1677590436.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group518387739.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1117570695.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1364826333.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2095924070.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group201890841.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1427662274.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group774800547.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group273195313.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group1743764551.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.group2057631278.geometry,material:t.mat10,castShadow:!0,receiveShadow:!0})]})}function Ce({position:o=[0,0,0],rotation:r=[0,0,0],scale:t=.5}){return e.jsx("group",{position:o,rotation:r,children:e.jsx(Re,{scale:t})})}function L({patchCount:o=10,radius:r=5,scale:t=1,position:s=[0,0,0]}){const a=[];for(let i=0;i<o;i++){const n=Math.random()*Math.PI*2,m=Math.random()*r,d=Math.cos(n)*m+s[0],u=Math.sin(n)*m+s[2],c=Math.random()*Math.PI*2,g=(.3+Math.random()*.4)*t;a.push(e.jsx(Ce,{position:[d,s[1]+.5,u],rotation:[0,c,0],scale:g},i))}return e.jsx("group",{children:a})}M.preload("/models/environment/grass.glb");function X({position:o,height:r=.1,radius:t=.6,buttonId:s}){const a=l.useRef(),i=l.useRef(),[n,m]=l.useState(!1),[d,u]=l.useState(0),c=w(f=>f.updatePressurePlate),g=new G("#ff0000"),y=new G("#00ff00"),[v,b]=l.useState(g);return _(()=>{a.current&&(d>0&&!n?(m(!0),b(y),c(s,!0)):d===0&&n&&(m(!1),b(g),c(s,!1)))}),e.jsxs("group",{position:o,children:[e.jsxs(h,{type:"fixed",colliders:!1,ref:i,children:[e.jsx(C,{args:[r-.1,t*1.1]})," ",e.jsxs("mesh",{receiveShadow:!0,castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[t,t*1.3,r,32]})," ",e.jsx("meshStandardMaterial",{color:"#555555"})]})]}),e.jsxs(h,{type:"fixed",position:[0,r+.05,0],colliders:!1,ref:a,sensor:!0,onIntersectionEnter:()=>{u(f=>f+1)},onIntersectionExit:()=>{u(f=>Math.max(0,f-1))},children:[e.jsx(C,{args:[.1,t-.1]}),e.jsxs("mesh",{receiveShadow:!0,castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[t-.1,t-.1,.1,32]}),e.jsx("meshStandardMaterial",{color:v})]})]})]})}function Z({position:o,buttonType:r="yes",height:t=.1,radius:s=.8}){const a=l.useRef(),i=l.useRef(),[n,m]=l.useState(!1),[d,u]=l.useState(0),c=w(I=>I.handleDateResponse),g=w(I=>I.dateProposalState.bothButtonsYes),y=g?"yes":r,v=new G("#00ff00"),b=new G("#ff0000"),[f,A]=l.useState(y==="yes"?v:b);return $.useEffect(()=>{A(y==="yes"?v:b)},[g,y]),_(()=>{a.current&&d>0&&!n&&(m(!0),c(y),setTimeout(()=>{m(!1),u(0)},500))}),e.jsxs("group",{position:o,children:[e.jsxs(h,{type:"fixed",colliders:!1,ref:i,children:[e.jsx(C,{args:[t-.05,s*1.1]})," ",e.jsxs("mesh",{receiveShadow:!0,castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[s,s*1.3,t,32]})," ",e.jsx("meshStandardMaterial",{color:"#555555"})]})]}),e.jsxs(h,{type:"fixed",position:[0,t+.05,0],colliders:!1,ref:a,sensor:!0,onIntersectionEnter:()=>{u(I=>I+1)},onIntersectionExit:()=>{u(I=>Math.max(0,I-1))},children:[e.jsx(C,{args:[.1,s-.1]}),e.jsxs("mesh",{receiveShadow:!0,castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[s-.1,s-.1,.1,32]}),e.jsx("meshStandardMaterial",{color:f})]}),e.jsx(H,{position:[0,.1,0],rotation:[-Math.PI/2,0,0],fontSize:.3,color:"#ffffff",anchorX:"center",anchorY:"middle",outlineWidth:.05,outlineColor:"#000000",children:y.toUpperCase()})]})]})}function Te({position:o=[0,2.5,-1]}){const r=w(m=>m.message),t=w(m=>m.showMessage);if(w(m=>m.stage)!==2)return null;const a=t?r:"Will you go on a date with me?",i="#ff69b4",n=t?.6:.5;return e.jsx(H,{position:o,fontSize:n,color:i,anchorX:"center",anchorY:"middle",outlineWidth:.05,outlineColor:"#000000",maxWidth:6,textAlign:"center",children:a})}function Ee(o){const{nodes:r,materials:t}=M("/models/environment/crate.glb");return e.jsx("group",{...o,dispose:null,children:e.jsxs("group",{rotation:[-Math.PI/2,0,0],scale:1,children:[e.jsx("mesh",{geometry:r.Crate_1.geometry,material:t.DarkWood,castShadow:!0,receiveShadow:!0}),e.jsx("mesh",{geometry:r.Crate_2.geometry,material:t.Wood,castShadow:!0,receiveShadow:!0})]})})}function P({position:o=[0,0,0],rotation:r=[0,0,0],scale:t=1}){return e.jsx("group",{position:o,rotation:r,children:e.jsx(Ee,{scale:t,position:[0,-.4,0]})})}M.preload("/models/environment/crate.glb");function ke({children:o}){const r=w(a=>a.stage),t=0,s=10;return e.jsxs("group",{children:[e.jsxs("mesh",{position:[0,t-1,0],rotation:[-Math.PI/2,0,0],receiveShadow:!0,children:[e.jsx("planeGeometry",{args:[70,40]})," ",e.jsx("meshStandardMaterial",{color:"#4d80e4",metalness:.2,roughness:.7,transparent:!0,opacity:.8})]}),e.jsxs(h,{type:"fixed",position:[0,t,0],colliders:!1,children:[e.jsx(C,{args:[.5,s]}),e.jsx(le,{scale:[s,1,s],receiveShadow:!0,children:e.jsx("meshStandardMaterial",{color:"#538D4E"})})]}),e.jsx(de,{position:[0,t+.001,0],scale:40,blur:2,opacity:.7,far:8,resolution:512,color:"#000000",frames:1}),r===1&&e.jsxs(e.Fragment,{children:[e.jsxs(h,{type:"dynamic",position:[3,t+.5,2],restitution:.2,friction:.8,colliders:!1,children:[e.jsx(P,{scale:511.5}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]}),e.jsxs(h,{type:"dynamic",position:[-2,t+.5,3],restitution:.2,friction:.8,colliders:!1,children:[e.jsx(P,{scale:511.2}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]}),e.jsxs(h,{type:"dynamic",position:[3,t+1.5,2],restitution:.2,friction:.8,colliders:!1,children:[e.jsx(P,{scale:511.8}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]}),e.jsxs(h,{type:"dynamic",position:[-2,t+1.5,3],restitution:.2,colliders:!1,children:[e.jsx(P,{scale:511.3}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]}),e.jsxs(h,{type:"dynamic",position:[5,t+.5,5],restitution:.2,colliders:!1,children:[e.jsx(P,{scale:511.4}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]}),e.jsxs(h,{type:"dynamic",position:[5,t+1.5,5],restitution:.2,colliders:!1,children:[e.jsx(P,{scale:511.2}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]}),e.jsxs(h,{type:"dynamic",position:[5,t+2.5,5],restitution:.2,colliders:!1,children:[e.jsx(P,{scale:511}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]}),e.jsxs(h,{type:"dynamic",position:[0,t+.5,6],restitution:.2,colliders:!1,children:[e.jsx(P,{scale:511.3}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]}),e.jsxs(h,{type:"dynamic",position:[2,t+.5,6],restitution:.2,colliders:!1,children:[e.jsx(P,{scale:511.3}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]}),e.jsxs(h,{type:"dynamic",position:[-2,t+.5,6],restitution:.2,colliders:!1,children:[e.jsx(P,{scale:511.3}),e.jsx(p,{args:[.4,.4,.4],position:[0,0,0]})]})]}),e.jsxs(h,{type:"fixed",position:[-5,t,-5],colliders:!1,children:[e.jsx(k,{type:"pine",scale:2,position:[0,3,0]})," ",e.jsx(p,{args:[.5,1.5,.5],position:[0,1.5,0]})," "]}),e.jsxs(h,{type:"fixed",position:[6,t,1],colliders:!1,children:[e.jsx(k,{type:"oak",scale:2,position:[0,3,0]})," ",e.jsx(p,{args:[.5,1.5,.5],position:[0,1.5,0]})," "]}),e.jsxs(h,{type:"fixed",position:[7,t,-4],colliders:!1,children:[e.jsx(k,{type:"willow",scale:2,position:[0,3,0]})," ",e.jsx(p,{args:[.5,1.5,.5],position:[0,1.5,0]})," "]}),e.jsxs(h,{type:"fixed",position:[-7,t,2],colliders:!1,children:[e.jsx(k,{type:"pine",scale:2,position:[0,3,0],rotation:[0,Math.PI/3,0]})," ",e.jsx(p,{args:[.5,1.5,.5],position:[0,1.5,0]})," "]}),e.jsxs(h,{type:"fixed",position:[0,t,-7],colliders:!1,children:[e.jsx(k,{type:"oak",scale:2,position:[0,3,0],rotation:[0,Math.PI/5,0]})," ",e.jsx(p,{args:[.5,1.5,.5],position:[0,1.5,0]})," "]}),e.jsxs(h,{type:"fixed",position:[8,t,3],colliders:!1,children:[e.jsx(k,{type:"willow",scale:2,position:[0,3,0],rotation:[0,Math.PI/6,0]})," ",e.jsx(p,{args:[.5,1.5,.5],position:[0,1.5,0]})," "]}),e.jsx(L,{patchCount:30,radius:s-2,scale:1.5,position:[0,t,0]}),e.jsx(L,{patchCount:8,radius:3,scale:1.7,position:[2,t,4]}),e.jsx(L,{patchCount:6,radius:2.5,scale:1.4,position:[-4,t,2]}),e.jsx(L,{patchCount:10,radius:3.2,scale:1.6,position:[3,t,-3]}),e.jsx(L,{patchCount:6,radius:2,scale:1.8,position:[-3,t,-4]}),r===1&&e.jsxs(e.Fragment,{children:[e.jsxs("group",{position:[4,t,0],children:[e.jsxs(h,{type:"fixed",colliders:!1,children:[e.jsx(C,{args:[2,1]}),e.jsxs("mesh",{receiveShadow:!0,castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[1,1,4,32]}),e.jsx("meshStandardMaterial",{color:"#777777"})]})]}),e.jsx(X,{position:[0,2,0],buttonId:"button-1"})]}),e.jsxs("group",{position:[-4,t,0],children:[e.jsxs(h,{type:"fixed",colliders:!1,children:[e.jsx(C,{args:[3,1]}),e.jsxs("mesh",{receiveShadow:!0,castShadow:!0,children:[e.jsx("cylinderGeometry",{args:[1,1,6,32]}),e.jsx("meshStandardMaterial",{color:"#777777"})]})]}),e.jsx(X,{position:[0,3,0],buttonId:"button-2"})]})]}),e.jsx(Te,{}),r===2&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{position:[-2,t+.5,.5],buttonType:"yes"}),e.jsx(Z,{position:[2,t+.5,.5],buttonType:"no"})]}),o]})}function Oe(){const o=w(c=>c.message),r=w(c=>c.showMessage),t=w(c=>c.stage),[s,a]=l.useState(0),i=l.useRef(),n=l.useRef(),[m,d]=l.useState(0);if(l.useEffect(()=>{r?(a(1),d(1)):(a(0),d(0))},[r]),_(c=>{if(i.current&&r){const g=c.clock.getElapsedTime();i.current.position.y=Math.sin(g*2)*.1,i.current.rotation.z=Math.sin(g*1.5)*.05;const y=1+Math.sin(g*3)*.05;i.current.scale.set(y,y,y)}n.current&&r&&(n.current.rotation.y=c.clock.getElapsedTime()*.5)}),t!==1||!r)return null;const u=[];for(let c=0;c<8;c++){const g=c/8*Math.PI*2,y=1.2,v=Math.cos(g)*y,b=Math.sin(g)*y,f=.1+Math.random()*.1;u.push(e.jsxs("mesh",{position:[v,b,0],scale:f,children:[Fe(),e.jsx("meshBasicMaterial",{color:"#ff69b4"})]},c))}return e.jsx(e.Fragment,{children:r&&e.jsxs("group",{position:[0,2.5,-1.5],scale:m,children:[e.jsx("group",{ref:n,children:u}),e.jsx("group",{ref:i,children:e.jsx(H,{position:[0,0,0],fontSize:.5,color:"#ff69b4",anchorX:"center",anchorY:"middle",outlineWidth:.05,outlineColor:"#ffffff",opacity:s,font:void 0,children:o})})]})})}function Fe(){return e.jsx("sphereGeometry",{args:[1,8,8]})}function Le(){const{active:o,progress:r}=he();return l.useEffect(()=>{if(!o&&r===100){const t=document.getElementById("loading-screen");t&&(t.style.opacity=0,setTimeout(()=>{t.style.display="none"},500))}},[o,r]),null}const Ae=()=>{const o=w(r=>r.stage);return e.jsxs("group",{children:[e.jsx(ge,{onDecline:r=>{console.log("Performance declining, current FPS:",r)}}),e.jsx("color",{attach:"background",args:["#A5D8FF"]}),e.jsxs("mesh",{position:[0,0,0],children:[e.jsx("sphereGeometry",{args:[5e3,32,32],attach:"geometry"}),e.jsx("meshBasicMaterial",{color:"#A5D8FF",side:fe,fog:!1,toneMapped:!1,attach:"material"})]}),e.jsx(ye,{preset:"sunset"}),e.jsx("ambientLight",{intensity:.4}),e.jsx("directionalLight",{position:[5,8,5],intensity:.8,castShadow:!0,color:"#A5D8FF","shadow-mapSize":[512,512],"shadow-camera-far":25,"shadow-camera-left":-12,"shadow-camera-right":12,"shadow-camera-top":12,"shadow-camera-bottom":-12,"shadow-bias":-5e-4,"shadow-radius":3,"shadow-normalBias":.05}),e.jsx(ke,{children:e.jsx(Ie,{})}),o===1&&e.jsx(Oe,{}),e.jsx(pe,{all:!0}),e.jsx(Le,{})]})},De="/r3f-game/assets/cat%20cafe-DvKxxiRK.mp3";function ze(){const[o,r]=l.useState(!1),[t,s]=l.useState(!1),a=l.useRef(null),i=l.useRef(null);return l.useEffect(()=>{const n=()=>{t||(s(!0),i.current&&i.current.state==="suspended"&&i.current.resume().then(()=>{console.log("AudioContext resumed successfully")}))};return window.addEventListener("click",n),window.addEventListener("keydown",n),window.addEventListener("touchstart",n),()=>{window.removeEventListener("click",n),window.removeEventListener("keydown",n),window.removeEventListener("touchstart",n)}},[t]),l.useEffect(()=>{const n=m=>{(m.key==="m"||m.key==="M")&&r(d=>{const u=!d;return a.current&&a.current.setVolume(u?0:.5),console.log(u?"Music muted":"Music unmuted"),u})};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[]),l.useEffect(()=>{if(a.current)return;const n=new je;i.current=n.context;const m=new ve(n);return a.current=m,new Pe().load(De,u=>{m.setBuffer(u),m.setLoop(!0),m.setVolume(o?0:.5),t?m.play():console.log("Music loaded. Waiting for user interaction to play..."),console.log("Background music ready. Press M to mute/unmute.")},u=>{console.log(u.loaded/u.total*100+"% loaded")},u=>{console.error("An error occurred while loading audio:",u)}),()=>{a.current&&(a.current.stop(),a.current.disconnect&&a.current.disconnect())}},[]),l.useEffect(()=>{if(t&&a.current)try{a.current.isPlaying||(a.current.play(),console.log("Music started after user interaction"))}catch(n){console.error("Failed to play audio:",n)}},[t]),l.useEffect(()=>{a.current&&a.current.setVolume(o?0:.5)},[o]),e.jsx("div",{className:"audio-controls",style:{position:"fixed",top:"20px",left:"20px",background:"rgba(0, 0, 0, 0.5)",color:"white",padding:"5px 10px",borderRadius:"5px",fontFamily:"Arial, sans-serif",fontSize:"14px",pointerEvents:"none",userSelect:"none",zIndex:1e3},children:t?o?"ðŸ”‡ Muted (Press M to unmute)":"ðŸ”Š Music On (Press M to mute)":"ðŸŽµ Click anywhere to start music"})}const Be=[{name:"forward",keys:["ArrowUp","KeyW"]},{name:"backward",keys:["ArrowDown","KeyS"]},{name:"leftward",keys:["ArrowLeft","KeyA"]},{name:"rightward",keys:["ArrowRight","KeyD"]},{name:"jump",keys:["Space"]}];function Ye(){function o(){return e.jsxs(e.Fragment,{children:[e.jsx(ze,{}),e.jsx(we,{map:Be,children:e.jsxs(ne,{shadows:{type:"PCFShadowMap"},camera:{position:[0,4.5,16],fov:40},dpr:[.8,1.2],performance:{min:.6},children:[e.jsx("color",{attach:"background",args:["#A5D8FF"]})," ",e.jsx(l.Suspense,{fallback:null,children:e.jsx(xe,{children:e.jsx(Ae,{})})})]})})]})}return e.jsx(o,{})}Se.createRoot(document.getElementById("root")).render(e.jsx($.StrictMode,{children:e.jsx(Ye,{})}));
